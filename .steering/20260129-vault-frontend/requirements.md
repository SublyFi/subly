# 要求定義書: Vault Frontend Dashboard

## 概要

Protocol B (subly-vault) 用のユーザーダッシュボードを作成する。
プライベートUSDC入金、残高表示、運用状況、定期送金設定、出金機能を提供する。

## 背景

現在のフロントエンド (`apps/dashboard-user`, `apps/dashboard-business`) は Protocol A (subly-membership / Devnet) 用であり、Protocol B (subly-vault / Mainnet) 用のUIは存在しない。

vault-sdk の実装は完了しているが、ユーザーがそれを利用するためのフロントエンドが必要。

## ターゲットユーザー

- DeFiユーザー（佐藤美咲ペルソナ）
- 複数のサブスクリプションを管理したい
- プライバシーを重視
- 運用益でサブスク料金を支払いたい

## 機能要件

### V1: プライベートUSDC入金機能

**ユーザーストーリー:**
ユーザーとして、USDCをプライベートに入金して、サブスクリプション料金の支払い原資を確保したい

**受け入れ条件:**
- [ ] 入金額（USDC）を入力できる
- [ ] Privacy Cash経由での入金フローが実行される
- [ ] 入金完了後、残高が更新される
- [ ] トランザクション署名が表示される
- [ ] エラー時に適切なメッセージが表示される

### V2: 残高・運用状況表示

**ユーザーストーリー:**
ユーザーとして、自分の資金状況を把握するために、残高と運用状況を確認したい

**受け入れ条件:**
- [ ] プライベート残高（シェア数、USDC換算額）が表示される
- [ ] Kamino運用の現在のAPYが表示される
- [ ] 獲得した運用益（Yield）が表示される
- [ ] プール全体の状況（total_pool_value, total_shares）が表示される

### V3: 定期送金設定機能

**ユーザーストーリー:**
ユーザーとして、事業者へのサブスクリプション料金を自動で支払うために、定期送金を設定したい

**受け入れ条件:**
- [ ] 送金先アドレス（事業者）を入力できる
- [ ] 送金額（USDC）を入力できる
- [ ] 送金間隔（時間/日/週/月）を選択できる
- [ ] メモ（オプション）を入力できる
- [ ] 設定完了後、定期送金一覧に追加される
- [ ] Tuk Tuk Cronジョブの有効化オプション（将来）

### V4: 定期送金一覧・管理

**ユーザーストーリー:**
ユーザーとして、設定した定期送金を管理したい

**受け入れ条件:**
- [ ] 設定済みの定期送金が一覧表示される
- [ ] 各定期送金の詳細（送金先、金額、間隔、次回実行日）が表示される
- [ ] 定期送金をキャンセルできる
- [ ] 手動実行ボタンがある（Tuk Tuk未使用時）

### V5: 出金機能

**ユーザーストーリー:**
ユーザーとして、必要に応じて資金を引き出したい

**受け入れ条件:**
- [ ] 出金額（USDC）を入力できる
- [ ] 出金先アドレスを入力できる（デフォルト: 自分のウォレット）
- [ ] Privacy Cash経由での出金が実行される
- [ ] 出金完了後、残高が更新される
- [ ] Kamino redemptionが自動的に行われる

## 非機能要件

### パフォーマンス
- ページ読み込み: 3秒以内
- トランザクション送信後のUI更新: 即座に「処理中」表示

### ユーザビリティ
- ウォレット接続から入金完了まで: 2分以内
- 定期送金設定: 1分以内

### セキュリティ
- Privacy Cash秘密鍵はブラウザに保存しない（毎回入力またはウォレット署名で導出）
- ローカルストレージ暗号化（送金先アドレス保存時）

## 技術的制約

- Next.js 15 + App Router
- Tailwind CSS（既存dashboard-userと統一）
- @solana/wallet-adapter-react
- @subly/vault-sdk
- Privacy Cash: Mainnet専用（Devnetテスト不可）

## スコープ外

- 入金履歴の永続化（オンチェーンには記録されるが、UIでの履歴表示は将来対応）
- 送金履歴の詳細表示
- 複数通貨対応（USDC以外）
- モバイル最適化（デスクトップ優先）

## 参考資料

- [Product Requirements](../../docs/product-requirements.md) - B4: ユーザーダッシュボード（Vault）
- [vault-sdk client.ts](../../subly-mainnet/packages/vault-sdk/src/client.ts)
- [dashboard-user](../../apps/dashboard-user) - 既存UIの参考
