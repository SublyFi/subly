# 要件: Arcium MXE サブスクリプションステータス暗号化

## 背景

現在の実装では、`Subscription`構造体の以下のフィールドが平文で保存されています：

- `is_active: bool` - サブスクリプションがアクティブかどうか
- `subscribed_at: i64` - 契約開始タイムスタンプ
- `cancelled_at: i64` - 解約タイムスタンプ

これにより、オンチェーンデータを分析する誰でも：
- どのユーザーがどのサービスを契約しているか
- いつ契約したか
- いつ解約したか

を特定できる状態です。

## 目的

Arcium MXEを使用して、サブスクリプションのステータス情報を暗号化し、プライバシーを保護します。

## 機能要件

### FR-1: 暗号化ステータスフィールド

- `is_active`を暗号化された形式で保存
- `subscribed_at`を暗号化された形式で保存
- `cancelled_at`を暗号化された形式で保存

### FR-2: Arcis回路

- `update_subscription_status`: ステータスを更新する回路
- `check_subscription_active`: アクティブかどうかを確認する回路（将来のZK証明用）

### FR-3: コールバック機能

- ステータス更新結果を受け取るコールバック関数

## 非機能要件

### NFR-1: 後方互換性

- 既存のプログラム構造を維持
- 既存のPDAシード構造を維持

### NFR-2: 段階的実装

- ZK証明統合は別フェーズで実施
- まずArcium暗号化のみを実装

## 制約事項

1. `#[arcium_program]`マクロと`#[program]`マクロは同時使用不可
2. `queue_computation` CPI統合は複雑なため、最小限の実装から開始
3. コールバック関数は`.arcis`ファイル生成後に完全統合

## 受け入れ条件

- [ ] Subscription構造体に暗号化ステータスフィールドが追加されている
- [ ] Arcis回路がビルドできる
- [ ] `cargo check`が成功する
- [ ] `arcium build`が成功する
- [ ] Devnetにデプロイできる
